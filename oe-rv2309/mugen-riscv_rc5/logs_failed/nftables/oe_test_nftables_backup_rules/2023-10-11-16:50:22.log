+ source /root/mugen/libs/locallibs/common_lib.sh
++ python3 --version
++ '[' 0 -eq 0 ']'
++ source /root/mugen/libs/locallibs/common_lib_python.sh
+ main
++ type -t post_test
+ '[' -n function ']'
+ trap post_test EXIT INT HUP TERM
+ rpm -qa
+ grep expect
++ type -t config_params
+ '[' -n '' ']'
++ type -t pre_test
+ '[' -n function ']'
+ pre_test
+ LOG_INFO 'Start to prepare the test environment.'
+ message='Start to prepare the test environment.'
+ python3 /root/mugen/libs/locallibs/mugen_log.py --level info --message 'Start to prepare the test environment.'
Wed Oct 11 16:50:24 2023 - INFO  - Start to prepare the test environment.
+ nft add table inet example_table
+ nft add chain inet example_table example_chain '{' type filter hook input priority 0 ';' policy accept ';' '}'
+ LOG_INFO 'End to prepare the test environment.'
+ message='End to prepare the test environment.'
+ python3 /root/mugen/libs/locallibs/mugen_log.py --level info --message 'End to prepare the test environment.'
Wed Oct 11 16:50:24 2023 - INFO  - End to prepare the test environment.
++ type -t run_test
+ '[' -n function ']'
+ run_test
+ LOG_INFO 'Start executing testcase.'
+ message='Start executing testcase.'
+ python3 /root/mugen/libs/locallibs/mugen_log.py --level info --message 'Start executing testcase.'
Wed Oct 11 16:50:25 2023 - INFO  - Start executing testcase.
+ nft list ruleset
+ grep -nr 'type filter hook input priority filter; policy accept;' file.nft
338:		type filter hook input priority filter; policy accept;
+ CHECK_RESULT 0 0 0 'backup to file.nft failed'
+ actual_result=0
+ expect_result=0
+ mode=0
+ error_log='backup to file.nft failed'
+ exit_mode=0
+ '[' -z 0 ']'
+ '[' 0 -eq 0 ']'
+ test 0x '!=' 0x
+ return 0
+ nft -j list ruleset
+ grep -nr '{"chain": {"family": "inet", "table": "example_table", "name": "example_chain", "handle": 1, "type": "filter", "hook": "input", "prio": 0, "policy": "accept"}}' file.json
1:{"nftables": [{"metainfo": {"version": "1.0.5", "release_name": "Lester Gooch #4", "json_schema_version": 1}}, {"table": {"family": "inet", "name": "firewalld", "handle": 6}}, {"chain": {"family": "inet", "table": "firewalld", "name": "mangle_PREROUTING", "handle": 1, "type": "filter", "hook": "prerouting", "prio": -140, "policy": "accept"}}, {"chain": {"family": "inet", "table": "firewalld", "name": "mangle_PREROUTING_POLICIES_pre", "handle": 2}}, {"chain": {"family": "inet", "table": "firewalld", "name": "mangle_PREROUTING_ZONES", "handle": 3}}, {"chain": {"family": "inet", "table": "firewalld", "name": "mangle_PREROUTING_POLICIES_post", "handle": 4}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_PREROUTING", "handle": 6, "type": "nat", "hook": "prerouting", "prio": -90, "policy": "accept"}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_PREROUTING_POLICIES_pre", "handle": 7}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_PREROUTING_ZONES", "handle": 8}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_PREROUTING_POLICIES_post", "handle": 9}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_POSTROUTING", "handle": 11, "type": "nat", "hook": "postrouting", "prio": 110, "policy": "accept"}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_POSTROUTING_POLICIES_pre", "handle": 12}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_POSTROUTING_ZONES", "handle": 13}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_POSTROUTING_POLICIES_post", "handle": 14}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_OUTPUT", "handle": 16, "type": "nat", "hook": "output", "prio": -90, "policy": "accept"}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_OUTPUT_POLICIES_pre", "handle": 17}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_OUTPUT_POLICIES_post", "handle": 19}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_PREROUTING", "handle": 21, "type": "filter", "hook": "prerouting", "prio": 10, "policy": "accept"}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_INPUT", "handle": 22, "type": "filter", "hook": "input", "prio": 10, "policy": "accept"}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_FORWARD", "handle": 23, "type": "filter", "hook": "forward", "prio": 10, "policy": "accept"}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_OUTPUT", "handle": 24, "type": "filter", "hook": "output", "prio": 10, "policy": "accept"}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_INPUT_POLICIES_pre", "handle": 30}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_INPUT_ZONES", "handle": 31}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_INPUT_POLICIES_post", "handle": 32}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_FORWARD_POLICIES_pre", "handle": 40}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_FORWARD_ZONES", "handle": 41}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_FORWARD_POLICIES_post", "handle": 43}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_OUTPUT_POLICIES_pre", "handle": 48}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_OUTPUT_POLICIES_post", "handle": 50}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_IN_public", "handle": 59}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_IN_public_pre", "handle": 60}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_IN_public_log", "handle": 61}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_IN_public_deny", "handle": 62}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_IN_public_allow", "handle": 63}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_IN_public_post", "handle": 64}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_POST_public", "handle": 83}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_POST_public_pre", "handle": 84}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_POST_public_log", "handle": 85}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_POST_public_deny", "handle": 86}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_POST_public_allow", "handle": 87}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_POST_public_post", "handle": 88}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_FWD_public", "handle": 96}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_FWD_public_pre", "handle": 97}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_FWD_public_log", "handle": 98}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_FWD_public_deny", "handle": 99}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_FWD_public_allow", "handle": 100}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_FWD_public_post", "handle": 101}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_PRE_public", "handle": 110}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_PRE_public_pre", "handle": 111}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_PRE_public_log", "handle": 112}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_PRE_public_deny", "handle": 113}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_PRE_public_allow", "handle": 114}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_PRE_public_post", "handle": 115}}, {"chain": {"family": "inet", "table": "firewalld", "name": "mangle_PRE_public", "handle": 123}}, {"chain": {"family": "inet", "table": "firewalld", "name": "mangle_PRE_public_pre", "handle": 124}}, {"chain": {"family": "inet", "table": "firewalld", "name": "mangle_PRE_public_log", "handle": 125}}, {"chain": {"family": "inet", "table": "firewalld", "name": "mangle_PRE_public_deny", "handle": 126}}, {"chain": {"family": "inet", "table": "firewalld", "name": "mangle_PRE_public_allow", "handle": 127}}, {"chain": {"family": "inet", "table": "firewalld", "name": "mangle_PRE_public_post", "handle": 128}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_IN_policy_allow-host-ipv6", "handle": 143}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_IN_policy_allow-host-ipv6_pre", "handle": 144}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_IN_policy_allow-host-ipv6_log", "handle": 145}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_IN_policy_allow-host-ipv6_deny", "handle": 146}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_IN_policy_allow-host-ipv6_allow", "handle": 147}}, {"chain": {"family": "inet", "table": "firewalld", "name": "filter_IN_policy_allow-host-ipv6_post", "handle": 148}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_PRE_policy_allow-host-ipv6", "handle": 154}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_PRE_policy_allow-host-ipv6_pre", "handle": 155}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_PRE_policy_allow-host-ipv6_log", "handle": 156}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_PRE_policy_allow-host-ipv6_deny", "handle": 157}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_PRE_policy_allow-host-ipv6_allow", "handle": 158}}, {"chain": {"family": "inet", "table": "firewalld", "name": "nat_PRE_policy_allow-host-ipv6_post", "handle": 159}}, {"chain": {"family": "inet", "table": "firewalld", "name": "mangle_PRE_policy_allow-host-ipv6", "handle": 165}}, {"chain": {"family": "inet", "table": "firewalld", "name": "mangle_PRE_policy_allow-host-ipv6_pre", "handle": 166}}, {"chain": {"family": "inet", "table": "firewalld", "name": "mangle_PRE_policy_allow-host-ipv6_log", "handle": 167}}, {"chain": {"family": "inet", "table": "firewalld", "name": "mangle_PRE_policy_allow-host-ipv6_deny", "handle": 168}}, {"chain": {"family": "inet", "table": "firewalld", "name": "mangle_PRE_policy_allow-host-ipv6_allow", "handle": 169}}, {"chain": {"family": "inet", "table": "firewalld", "name": "mangle_PRE_policy_allow-host-ipv6_post", "handle": 170}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "mangle_PREROUTING", "handle": 5, "expr": [{"jump": {"target": "mangle_PREROUTING_ZONES"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "mangle_PREROUTING_POLICIES_pre", "handle": 178, "expr": [{"jump": {"target": "mangle_PRE_policy_allow-host-ipv6"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "mangle_PREROUTING_ZONES", "handle": 187, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "eth0"}}, {"goto": {"target": "mangle_PRE_public"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "mangle_PREROUTING_ZONES", "handle": 142, "expr": [{"goto": {"target": "mangle_PRE_public"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_PREROUTING", "handle": 10, "expr": [{"jump": {"target": "nat_PREROUTING_ZONES"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_PREROUTING_POLICIES_pre", "handle": 177, "expr": [{"jump": {"target": "nat_PRE_policy_allow-host-ipv6"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_PREROUTING_ZONES", "handle": 186, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "eth0"}}, {"goto": {"target": "nat_PRE_public"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_PREROUTING_ZONES", "handle": 141, "expr": [{"goto": {"target": "nat_PRE_public"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_POSTROUTING", "handle": 15, "expr": [{"jump": {"target": "nat_POSTROUTING_ZONES"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_POSTROUTING_ZONES", "handle": 184, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "eth0"}}, {"goto": {"target": "nat_POST_public"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_POSTROUTING_ZONES", "handle": 139, "expr": [{"goto": {"target": "nat_POST_public"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_OUTPUT", "handle": 18, "expr": [{"jump": {"target": "nat_OUTPUT_POLICIES_pre"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_OUTPUT", "handle": 20, "expr": [{"jump": {"target": "nat_OUTPUT_POLICIES_post"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_PREROUTING", "handle": 54, "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "icmpv6", "field": "type"}}, "right": {"set": ["nd-router-advert", "nd-neighbor-solicit"]}}}, {"accept": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_PREROUTING", "handle": 52, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "nfproto"}}, "right": "ipv6"}}, {"match": {"op": "==", "left": {"fib": {"result": "oif", "flags": ["saddr", "mark", "iif"]}}, "right": false}}, {"drop": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_INPUT", "handle": 26, "expr": [{"match": {"op": "==", "left": {"ct": {"key": "state"}}, "right": {"set": ["established", "related"]}}}, {"accept": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_INPUT", "handle": 27, "expr": [{"match": {"op": "in", "left": {"ct": {"key": "status"}}, "right": "dnat"}}, {"accept": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_INPUT", "handle": 28, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "lo"}}, {"accept": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_INPUT", "handle": 29, "expr": [{"match": {"op": "in", "left": {"ct": {"key": "state"}}, "right": "invalid"}}, {"drop": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_INPUT", "handle": 33, "expr": [{"jump": {"target": "filter_INPUT_ZONES"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_INPUT", "handle": 34, "expr": [{"reject": {"type": "icmpx", "expr": "admin-prohibited"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_FORWARD", "handle": 36, "expr": [{"match": {"op": "==", "left": {"ct": {"key": "state"}}, "right": {"set": ["established", "related"]}}}, {"accept": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_FORWARD", "handle": 37, "expr": [{"match": {"op": "in", "left": {"ct": {"key": "status"}}, "right": "dnat"}}, {"accept": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_FORWARD", "handle": 38, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "lo"}}, {"accept": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_FORWARD", "handle": 39, "expr": [{"match": {"op": "in", "left": {"ct": {"key": "state"}}, "right": "invalid"}}, {"drop": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_FORWARD", "handle": 58, "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "ip6", "field": "daddr"}}, "right": {"set": [{"prefix": {"addr": "::", "len": 96}}, {"prefix": {"addr": "::ffff:0.0.0.0", "len": 96}}, {"prefix": {"addr": "2002::", "len": 24}}, {"prefix": {"addr": "2002:a00::", "len": 24}}, {"prefix": {"addr": "2002:7f00::", "len": 24}}, {"prefix": {"addr": "2002:a9fe::", "len": 32}}, {"prefix": {"addr": "2002:ac10::", "len": 28}}, {"prefix": {"addr": "2002:c0a8::", "len": 32}}, {"prefix": {"addr": "2002:e000::", "len": 19}}]}}}, {"reject": {"type": "icmpv6", "expr": "addr-unreachable"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_FORWARD", "handle": 42, "expr": [{"jump": {"target": "filter_FORWARD_ZONES"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_FORWARD", "handle": 44, "expr": [{"reject": {"type": "icmpx", "expr": "admin-prohibited"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_OUTPUT", "handle": 46, "expr": [{"match": {"op": "==", "left": {"ct": {"key": "state"}}, "right": {"set": ["established", "related"]}}}, {"accept": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_OUTPUT", "handle": 47, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "lo"}}, {"accept": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_OUTPUT", "handle": 56, "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "ip6", "field": "daddr"}}, "right": {"set": [{"prefix": {"addr": "::", "len": 96}}, {"prefix": {"addr": "::ffff:0.0.0.0", "len": 96}}, {"prefix": {"addr": "2002::", "len": 24}}, {"prefix": {"addr": "2002:a00::", "len": 24}}, {"prefix": {"addr": "2002:7f00::", "len": 24}}, {"prefix": {"addr": "2002:a9fe::", "len": 32}}, {"prefix": {"addr": "2002:ac10::", "len": 28}}, {"prefix": {"addr": "2002:c0a8::", "len": 32}}, {"prefix": {"addr": "2002:e000::", "len": 19}}]}}}, {"reject": {"type": "icmpv6", "expr": "addr-unreachable"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_OUTPUT", "handle": 49, "expr": [{"jump": {"target": "filter_OUTPUT_POLICIES_pre"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_OUTPUT", "handle": 51, "expr": [{"jump": {"target": "filter_OUTPUT_POLICIES_post"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_INPUT_POLICIES_pre", "handle": 176, "expr": [{"jump": {"target": "filter_IN_policy_allow-host-ipv6"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_INPUT_ZONES", "handle": 183, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "eth0"}}, {"goto": {"target": "filter_IN_public"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_INPUT_ZONES", "handle": 138, "expr": [{"goto": {"target": "filter_IN_public"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_FORWARD_ZONES", "handle": 185, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "iifname"}}, "right": "eth0"}}, {"goto": {"target": "filter_FWD_public"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_FORWARD_ZONES", "handle": 140, "expr": [{"goto": {"target": "filter_FWD_public"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_public", "handle": 65, "expr": [{"jump": {"target": "filter_INPUT_POLICIES_pre"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_public", "handle": 66, "expr": [{"jump": {"target": "filter_IN_public_pre"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_public", "handle": 67, "expr": [{"jump": {"target": "filter_IN_public_log"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_public", "handle": 68, "expr": [{"jump": {"target": "filter_IN_public_deny"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_public", "handle": 69, "expr": [{"jump": {"target": "filter_IN_public_allow"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_public", "handle": 70, "expr": [{"jump": {"target": "filter_IN_public_post"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_public", "handle": 71, "expr": [{"jump": {"target": "filter_INPUT_POLICIES_post"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_public", "handle": 137, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "l4proto"}}, "right": {"set": ["icmp", "ipv6-icmp"]}}}, {"accept": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_public", "handle": 72, "expr": [{"reject": {"type": "icmpx", "expr": "admin-prohibited"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_public_allow", "handle": 74, "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "dport"}}, "right": 22}}, {"match": {"op": "==", "left": {"ct": {"key": "state"}}, "right": {"set": ["new", "untracked"]}}}, {"accept": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_public_allow", "handle": 76, "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "ip", "field": "daddr"}}, "right": "224.0.0.251"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "udp", "field": "dport"}}, "right": 5353}}, {"match": {"op": "==", "left": {"ct": {"key": "state"}}, "right": {"set": ["new", "untracked"]}}}, {"accept": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_public_allow", "handle": 78, "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "ip6", "field": "daddr"}}, "right": "ff02::fb"}}, {"match": {"op": "==", "left": {"payload": {"protocol": "udp", "field": "dport"}}, "right": 5353}}, {"match": {"op": "==", "left": {"ct": {"key": "state"}}, "right": {"set": ["new", "untracked"]}}}, {"accept": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_public_allow", "handle": 80, "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "ip6", "field": "daddr"}}, "right": {"prefix": {"addr": "fe80::", "len": 64}}}}, {"match": {"op": "==", "left": {"payload": {"protocol": "udp", "field": "dport"}}, "right": 546}}, {"match": {"op": "==", "left": {"ct": {"key": "state"}}, "right": {"set": ["new", "untracked"]}}}, {"accept": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_public_allow", "handle": 82, "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "tcp", "field": "dport"}}, "right": 8009}}, {"match": {"op": "==", "left": {"ct": {"key": "state"}}, "right": {"set": ["new", "untracked"]}}}, {"accept": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_POST_public", "handle": 89, "expr": [{"jump": {"target": "nat_POSTROUTING_POLICIES_pre"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_POST_public", "handle": 90, "expr": [{"jump": {"target": "nat_POST_public_pre"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_POST_public", "handle": 91, "expr": [{"jump": {"target": "nat_POST_public_log"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_POST_public", "handle": 92, "expr": [{"jump": {"target": "nat_POST_public_deny"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_POST_public", "handle": 93, "expr": [{"jump": {"target": "nat_POST_public_allow"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_POST_public", "handle": 94, "expr": [{"jump": {"target": "nat_POST_public_post"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_POST_public", "handle": 95, "expr": [{"jump": {"target": "nat_POSTROUTING_POLICIES_post"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_FWD_public", "handle": 102, "expr": [{"jump": {"target": "filter_FORWARD_POLICIES_pre"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_FWD_public", "handle": 103, "expr": [{"jump": {"target": "filter_FWD_public_pre"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_FWD_public", "handle": 104, "expr": [{"jump": {"target": "filter_FWD_public_log"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_FWD_public", "handle": 105, "expr": [{"jump": {"target": "filter_FWD_public_deny"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_FWD_public", "handle": 106, "expr": [{"jump": {"target": "filter_FWD_public_allow"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_FWD_public", "handle": 107, "expr": [{"jump": {"target": "filter_FWD_public_post"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_FWD_public", "handle": 108, "expr": [{"jump": {"target": "filter_FORWARD_POLICIES_post"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_FWD_public", "handle": 109, "expr": [{"reject": {"type": "icmpx", "expr": "admin-prohibited"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_FWD_public_allow", "handle": 188, "expr": [{"match": {"op": "==", "left": {"meta": {"key": "oifname"}}, "right": "eth0"}}, {"accept": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_PRE_public", "handle": 116, "expr": [{"jump": {"target": "nat_PREROUTING_POLICIES_pre"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_PRE_public", "handle": 117, "expr": [{"jump": {"target": "nat_PRE_public_pre"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_PRE_public", "handle": 118, "expr": [{"jump": {"target": "nat_PRE_public_log"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_PRE_public", "handle": 119, "expr": [{"jump": {"target": "nat_PRE_public_deny"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_PRE_public", "handle": 120, "expr": [{"jump": {"target": "nat_PRE_public_allow"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_PRE_public", "handle": 121, "expr": [{"jump": {"target": "nat_PRE_public_post"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_PRE_public", "handle": 122, "expr": [{"jump": {"target": "nat_PREROUTING_POLICIES_post"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "mangle_PRE_public", "handle": 129, "expr": [{"jump": {"target": "mangle_PREROUTING_POLICIES_pre"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "mangle_PRE_public", "handle": 130, "expr": [{"jump": {"target": "mangle_PRE_public_pre"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "mangle_PRE_public", "handle": 131, "expr": [{"jump": {"target": "mangle_PRE_public_log"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "mangle_PRE_public", "handle": 132, "expr": [{"jump": {"target": "mangle_PRE_public_deny"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "mangle_PRE_public", "handle": 133, "expr": [{"jump": {"target": "mangle_PRE_public_allow"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "mangle_PRE_public", "handle": 134, "expr": [{"jump": {"target": "mangle_PRE_public_post"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "mangle_PRE_public", "handle": 135, "expr": [{"jump": {"target": "mangle_PREROUTING_POLICIES_post"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_policy_allow-host-ipv6", "handle": 149, "expr": [{"jump": {"target": "filter_IN_policy_allow-host-ipv6_pre"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_policy_allow-host-ipv6", "handle": 150, "expr": [{"jump": {"target": "filter_IN_policy_allow-host-ipv6_log"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_policy_allow-host-ipv6", "handle": 151, "expr": [{"jump": {"target": "filter_IN_policy_allow-host-ipv6_deny"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_policy_allow-host-ipv6", "handle": 152, "expr": [{"jump": {"target": "filter_IN_policy_allow-host-ipv6_allow"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_policy_allow-host-ipv6", "handle": 153, "expr": [{"jump": {"target": "filter_IN_policy_allow-host-ipv6_post"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_policy_allow-host-ipv6_allow", "handle": 179, "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "icmpv6", "field": "type"}}, "right": "nd-neighbor-advert"}}, {"accept": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_policy_allow-host-ipv6_allow", "handle": 180, "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "icmpv6", "field": "type"}}, "right": "nd-neighbor-solicit"}}, {"accept": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_policy_allow-host-ipv6_allow", "handle": 181, "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "icmpv6", "field": "type"}}, "right": "nd-router-advert"}}, {"accept": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "filter_IN_policy_allow-host-ipv6_allow", "handle": 182, "expr": [{"match": {"op": "==", "left": {"payload": {"protocol": "icmpv6", "field": "type"}}, "right": "nd-redirect"}}, {"accept": null}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_PRE_policy_allow-host-ipv6", "handle": 160, "expr": [{"jump": {"target": "nat_PRE_policy_allow-host-ipv6_pre"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_PRE_policy_allow-host-ipv6", "handle": 161, "expr": [{"jump": {"target": "nat_PRE_policy_allow-host-ipv6_log"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_PRE_policy_allow-host-ipv6", "handle": 162, "expr": [{"jump": {"target": "nat_PRE_policy_allow-host-ipv6_deny"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_PRE_policy_allow-host-ipv6", "handle": 163, "expr": [{"jump": {"target": "nat_PRE_policy_allow-host-ipv6_allow"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "nat_PRE_policy_allow-host-ipv6", "handle": 164, "expr": [{"jump": {"target": "nat_PRE_policy_allow-host-ipv6_post"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "mangle_PRE_policy_allow-host-ipv6", "handle": 171, "expr": [{"jump": {"target": "mangle_PRE_policy_allow-host-ipv6_pre"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "mangle_PRE_policy_allow-host-ipv6", "handle": 172, "expr": [{"jump": {"target": "mangle_PRE_policy_allow-host-ipv6_log"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "mangle_PRE_policy_allow-host-ipv6", "handle": 173, "expr": [{"jump": {"target": "mangle_PRE_policy_allow-host-ipv6_deny"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "mangle_PRE_policy_allow-host-ipv6", "handle": 174, "expr": [{"jump": {"target": "mangle_PRE_policy_allow-host-ipv6_allow"}}]}}, {"rule": {"family": "inet", "table": "firewalld", "chain": "mangle_PRE_policy_allow-host-ipv6", "handle": 175, "expr": [{"jump": {"target": "mangle_PRE_policy_allow-host-ipv6_post"}}]}}, {"table": {"family": "inet", "name": "example_table", "handle": 7}}, {"chain": {"family": "inet", "table": "example_table", "name": "example_chain", "handle": 1, "type": "filter", "hook": "input", "prio": 0, "policy": "accept"}}]}
+ CHECK_RESULT 0 0 0 'backup to file.json failed'
+ actual_result=0
+ expect_result=0
+ mode=0
+ error_log='backup to file.json failed'
+ exit_mode=0
+ '[' -z 0 ']'
+ '[' 0 -eq 0 ']'
+ test 0x '!=' 0x
+ return 0
+ nft delete table inet example_table
+ nft list chains
+ grep example_chain
+ CHECK_RESULT 1 1 0 'exec '\''nft delete table inet example_table'\'' failed'
+ actual_result=1
+ expect_result=1
+ mode=0
+ error_log='exec '\''nft delete table inet example_table'\'' failed'
+ exit_mode=0
+ '[' -z 1 ']'
+ '[' 0 -eq 0 ']'
+ test 1x '!=' 1x
+ return 0
+ nft -f file.nft
+ nft list chains
+ grep example_chain
	chain example_chain {
+ CHECK_RESULT 0 0 0 'restores from file.nft failed'
+ actual_result=0
+ expect_result=0
+ mode=0
+ error_log='restores from file.nft failed'
+ exit_mode=0
+ '[' -z 0 ']'
+ '[' 0 -eq 0 ']'
+ test 0x '!=' 0x
+ return 0
+ nft delete table inet example_table
+ nft list chains
+ grep example_chain
+ CHECK_RESULT 1 1 0 'exec '\''nft delete table inet example_table'\'' failed'
+ actual_result=1
+ expect_result=1
+ mode=0
+ error_log='exec '\''nft delete table inet example_table'\'' failed'
+ exit_mode=0
+ '[' -z 1 ']'
+ '[' 0 -eq 0 ']'
+ test 1x '!=' 1x
+ return 0
+ nft -j -f file.json
+ nft list chains
+ grep example_chain
	chain example_chain {
+ CHECK_RESULT 0 0 0 'restores from file.json failed'
+ actual_result=0
+ expect_result=0
+ mode=0
+ error_log='restores from file.json failed'
+ exit_mode=0
+ '[' -z 0 ']'
+ '[' 0 -eq 0 ']'
+ test 0x '!=' 0x
+ return 0
+ LOG_INFO 'Finish testcase execution.'
+ message='Finish testcase execution.'
+ python3 /root/mugen/libs/locallibs/mugen_log.py --level info --message 'Finish testcase execution.'
Wed Oct 11 16:50:26 2023 - INFO  - Finish testcase execution.
+ CASE_RESULT 0
+ case_re=0
+ test -z ''
+ test 0 -eq 0
+ LOG_INFO 'succeed to execute the case.'
+ message='succeed to execute the case.'
+ python3 /root/mugen/libs/locallibs/mugen_log.py --level info --message 'succeed to execute the case.'
Wed Oct 11 16:50:26 2023 - INFO  - succeed to execute the case.
+ exec_result=
+ exit 0
+ post_test
+ LOG_INFO 'start environment cleanup.'
+ message='start environment cleanup.'
+ python3 /root/mugen/libs/locallibs/mugen_log.py --level info --message 'start environment cleanup.'
Wed Oct 11 16:50:27 2023 - INFO  - start environment cleanup.
+ nft delete table inet example_table
+ rm -rf file.json file.nft
+ LOG_INFO 'Finish environment cleanup!'
+ message='Finish environment cleanup!'
+ python3 /root/mugen/libs/locallibs/mugen_log.py --level info --message 'Finish environment cleanup!'
Wed Oct 11 16:50:27 2023 - INFO  - Finish environment cleanup!
